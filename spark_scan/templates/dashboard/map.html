<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Map Dashboard</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<!-- Custom CSS -->
<link rel="stylesheet" href="/static/style.css">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<div id="top-bar">
    <div id="logo">
        <img src="https://leafletjs.com/docs/images/logo.png" alt="Logo">
        <span>MyApp</span>
    </div>
    <div id="search-container">
        <input type="search" placeholder="Search by ZIP or Address..." id="search">
    </div>
    <div id="menu-buttons">
        <button id="btn-stations">Stations</button>
        <button id="btn-tickets">Tickets</button>
        <button id="btn-settings">Settings</button>
        <div id="username">JohnDoe</div>
    </div>
</div>

<div id="map-container">
    <div id="map"></div>

    <div id="left-overlay">
        <canvas id="issuePieChart"></canvas>
        <div id="chart-date">Date: 2025-09-27</div>
        <div id="issue-labels">
            <div class="opened">Opened Issues: <span id="opened-count">15</span></div>
            <div class="closed">Closed Issues: <span id="closed-count">30</span></div>
            <div class="active">Active Issues: <span id="active-count">8</span></div>
        </div>
    </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
/* Initialize Leaflet Map */
var map = L.map('map').setView([8.9272, 76.6377], 13);
L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; <a href="https://carto.com/attributions">CARTO</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    maxZoom: 19
}).addTo(map);

var bounds = [[8.92, 76.62], [8.94, 76.65]];
L.rectangle(bounds, {color: "#0ff", weight: 3, opacity: 0.8, fillOpacity: 0.2}).addTo(map);
map.fitBounds(bounds);

/* Donut Chart */
var ctx = document.getElementById('issuePieChart').getContext('2d');
var opened = 15, closed = 30, active = 8;

var data = {
    labels: ['Opened', 'Closed', 'Active'],
    datasets: [{
        data: [opened, closed, active],
        backgroundColor: ['#ff4b5c', '#1abc9c', '#f7b733'],
        borderColor: 'rgba(0,0,0,0.2)',
        borderWidth: 2,
        hoverOffset: 15
    }]
};

var config = {
    type: 'doughnut',
    data: data,
    options: {
        responsive: false,
        cutout: '70%',
        animation: { animateScale: true },
        plugins: {
            legend: { position: 'bottom', labels: { color: '#0ff', font: { size: 14 }, boxWidth: 15 } },
            tooltip: { enabled: true, backgroundColor: 'rgba(0,0,0,0.7)', titleColor: '#0ff', bodyColor: '#fff' }
        }
    }
};

new Chart(ctx, config);

/* UI interactions */
document.getElementById('search').addEventListener('keyup', e => { if(e.key === 'Enter'){ alert('Search: ' + e.target.value); }});
document.getElementById('btn-stations').onclick = () => alert('Stations clicked');
document.getElementById('btn-tickets').onclick = () => alert('Tickets clicked');
document.getElementById('btn-settings').onclick = () => alert('Settings clicked');
</script>

</body>
</html>
